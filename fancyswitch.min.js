!function(window,$){function change(SELF,index,index2){Fancy.template&&SELF.templates.forEach(function(it){it.update()}),SELF.settings.onSwitch.call(SELF,index,index2)}function swapArrayElements(arr,indexA,indexB){var temp=arr[indexA];arr[indexA]=arr[indexB],arr[indexB]=temp,arr[indexA].$index=indexA,arr[indexB].$index=indexB}function FancySwitch(element,settings,list){var SELF=this;if(SELF.settings=$.extend({},Fancy.settings[NAME],settings),delete SELF.settings.templates,"offset"!=SELF.settings.clonePosition&&"position"!=SELF.settings.clonePosition&&(SELF.settings.clonePosition="offset"),SELF.settings.itemSelector+=":not(."+NAME+"-draggable-clone)",SELF.visible=!1,logged||(logged=!0,Fancy.version(SELF)),SELF.list=list||[],SELF.element=element,SELF.version=VERSION,SELF.name=NAME,SELF.items=SELF.element.find(SELF.settings.itemSelector),SELF.animating=!1,Fancy.template&&(SELF.templates=[]),SELF.list.length){if(!SELF.settings.template&&(SELF.settings.drag?SELF.settings.template=templateDrag:SELF.settings.upText&&SELF.settings.downText?SELF.settings.template=template:SELF.settings.upClass&&SELF.settings.downClass&&(SELF.settings.template=templateIcon),!SELF.settings.template))throw"Error: could not define template"}else SELF.element.on("DOMNodeInserted."+NAME+"DOMNodeRemoved."+NAME,function(){SELF.element.find(SELF.settings.itemSelector).length!=SELF.items.length&&SELF.update()});return SELF.element.addClass(NAME+"-element"),SELF.settings.drag&&SELF.element.addClass(NAME+"-draggable"),SELF.process(),SELF}Fancy.require({jQuery:!1,Fancy:"1.0.1"});var NAME="FancySwitch",VERSION="1.1.1",$doc=$(document),logged=!1,template='<div class="FancySwitch-item">{{name}}<div class="FancySwitch-up">$upText$</div><div class="FancySwitch-down">$downText$</div></div>',templateIcon='<div class="FancySwitch-item">{{name}}<div class="FancySwitch-up $upClass$"></div><div class="FancySwitch-down $downClass$"></div></div>',templateDrag='<div class="FancySwitch-item">{{name}}</div>';FancySwitch.api=FancySwitch.prototype={},FancySwitch.api.version=VERSION,FancySwitch.api.name=NAME,FancySwitch.api.up=function(item,animated){var SELF=this,prev=item.prev();if(prev.length){var index=SELF.items.index(item);SELF.list.length&&swapArrayElements(SELF.list,index,index-1),animated===!1||SELF.settings.animated===!1?(item.insertBefore(prev),SELF.items=SELF.element.find(SELF.settings.itemSelector),change(SELF,index,index-1)):SELF.animating||(SELF.animating=!SELF.animating,item.css("position","relative").animate({top:"-"+prev.height()+"px"},500,function(){item.css("position",item.data("position")).css("top",item.data("top"))}),prev.css("position","relative").animate({top:"+"+item.height()+"px"},500,function(){prev.css("position",prev.data("position")).css("top",prev.data("top")),item.insertBefore(prev),SELF.animating=!SELF.animating,SELF.items=SELF.element.find(SELF.settings.itemSelector),change(SELF,index,index-1)}))}},FancySwitch.api.down=function(item,animated){var SELF=this,next=item.next();if(item.next().length){var index=SELF.items.index(item);SELF.list.length&&swapArrayElements(SELF.list,index,index+1),animated===!1||SELF.settings.animated===!1?(item.insertAfter(next),SELF.items=SELF.element.find(SELF.settings.itemSelector),change(SELF,index,index+1)):SELF.animating||(SELF.animating=!SELF.animating,item.css("position","relative").animate({top:"+"+next.height()+"px"},500,function(){item.css("position",item.data("position")).css("top",item.data("top"))}),next.css("position","relative").animate({top:"-"+item.height()+"px"},500,function(){next.css("position",next.data("position")).css("top",next.data("top")),item.insertAfter(next),SELF.animating=!SELF.animating,swapArrayElements(SELF.items,index,index+1),SELF.items=SELF.element.find(SELF.settings.itemSelector),change(SELF,index,index+1)}))}},FancySwitch.api.update=function(){this.list.length||(this.items=this.element.find(this.settings.itemSelector)),this.process()},FancySwitch.api.process=function(){function processTemplateItem(item){item.data("processed",!0).data("position","static"===item.css("position")?"":item.css("position")).data("top","auto"===item.css("top")?"":item.css("top"));var $el;if(item.find(SELF.settings.upSelector).length||SELF.settings.drag?SELF.settings.drag&&item.find(SELF.settings.upSelector).remove():($el=0===SELF.settings.upSelector.indexOf(".")?$("<div/>",{"class":SELF.settings.upSelector.substr(1)}):$("<"+SELF.settings.upSelector+"/>"),$el.addClass(SELF.settings.upClass).html(SELF.settings.upText),item.append($el)),item.find(SELF.settings.downSelector).length||SELF.settings.drag?SELF.settings.drag&&item.find(SELF.settings.downSelector).remove():($el=0===SELF.settings.downSelector.indexOf(".")?$("<div/>",{"class":SELF.settings.downSelector.substr(1)}):$("<"+SELF.settings.downSelector+"/>"),$el.addClass(SELF.settings.downClass).html(SELF.settings.downText),item.append($el)),SELF.settings.drag){item.addClass(NAME+"-draggable-item");var offset,position,handler=SELF.settings.handler?item.find(SELF.settings.handler):item;Fancy(handler).preventSelect().on("mousedown."+NAME,function(e){var clone;if(1===e.which){Fancy($("body")).preventSelect();var parent=Fancy.scrollParent(item);if(parent&&parent.length){var lastTop=parent[0].scrollTop;parent.on("scroll."+NAME+" DOMMouseScroll."+NAME+" mousewheel."+NAME,function(){lastTop<this.scrollTop?(position.y-=this.scrollTop-lastTop,offset.y-=this.scrollTop-lastTop):(position.y+=lastTop-this.scrollTop,offset.y+=lastTop-this.scrollTop),lastTop=this.scrollTop})}offset={x:e.pageX-item.offset().left,y:e.pageY-item.offset().top},position={x:e.pageX-item.position().left,y:e.pageY-item.position().top},SELF.settings.onChangeStart.call(SELF),$doc.on("mousemove."+NAME,function(event){if(!clone){clone=item.clone(),"string"==Fancy.getType(SELF.settings.cloneAppendTo)?$(SELF.settings.cloneAppendTo).append(clone):"function"==Fancy.getType(SELF.settings.cloneAppendTo)&&SELF.settings.cloneAppendTo.call(SELF,item).append(clone),clone.css({width:Fancy(item).fullWidth(),zIndex:(parseInt(item.css("zIndex"))||10)+1}).addClass(NAME+"-draggable-clone").addClass(SELF.settings.cloneClass),SELF.settings.compileClone&&SELF.settings.compileClone.call(SELF,clone,item);var index=SELF.items.index(clone);index>-1&&SELF.items.splice(index,1)}"offset"==SELF.settings.clonePosition?clone.css({top:Math.min(SELF.items.last().offset().top,Math.max(SELF.items.first().offset().top,event.pageY-offset.y)),left:item.offset().left-parent[0].scrollLeft}):clone.css({top:Math.min(SELF.items.last().position().top,Math.max(SELF.items.first().position().top,event.pageY-position.y)),left:item.position().left}),clone[SELF.settings.clonePosition]().top>item[SELF.settings.clonePosition]().top+item.height()/3*2?SELF.down(item,!1):clone[SELF.settings.clonePosition]().top+item.height()/3*2<item[SELF.settings.clonePosition]().top&&SELF.up(item,!1)}).on("mouseup."+NAME,function(event){1===event.which&&(parent.off("."+NAME),clone?(Fancy("body").allowSelect(),clone.css("top")!==item[SELF.settings.clonePosition]().top?clone.animate({top:item[SELF.settings.clonePosition]().top},300,function(){clone.remove(),clone=null}):(clone.remove(),clone=null),$doc.off("."+NAME)):$doc.off("."+NAME),SELF.settings.onChange.call(SELF))})}})}else Fancy(item.find(SELF.settings.upSelector)).preventSelect().click(function(){SELF.up(item)}),Fancy(item.find(SELF.settings.downSelector)).preventSelect().click(function(){SELF.down(item)})}var SELF=this;SELF.list.length?SELF.list.forEach(function(it,i){it.$index=i;var item,template=SELF.settings.template.replace(/\$([^$}]*)\$/g,function(match,$1){return SELF.settings[$1.trim()]});Fancy.template||(template=template.replace(/\{\{([^\{}]*)\}\}/g,function(match,$1){return it[$1.trim()]})),item=$(template),Fancy.template&&SELF.templates.push(Fancy(item).template({scope:it}).compile()),SELF.element.append(item),SELF.items=SELF.items.add(item),processTemplateItem(SELF.settings.handler?item.find(SELF.settings.handler):item)}):SELF.items.each(function(){var item=$(this);item.data("processed")||processTemplateItem(item)})},FancySwitch.api.destroy=function(){var SELF=this;SELF.items.each(function(){var item=$(this);item.data("processed",void 0).data("position",void 0).data("top",void 0),item.off("."+NAME),item.find(SELF.settings.downSelector).remove(),item.find(SELF.settings.upSelector).remove()})},Fancy.settings[NAME]={drag:!1,animated:!0,itemSelector:".FancySwitch-item",upSelector:".FancySwitch-up",downSelector:".FancySwitch-down",upClass:!1,downClass:!1,cloneAppendTo:"body",compileClone:!1,cloneClass:!1,clonePosition:"offset",upText:"Up",downText:"Down",template:!1,templates:{buttonText:template,buttonClass:templateIcon,drag:templateDrag},onChangeStart:function(){},onChange:function(){},onSwitch:function(){},handler:!1},Fancy["switch"]=VERSION,Fancy.api["switch"]=function(settings,list){return this.set(NAME,function(el){return new FancySwitch(el,settings,list)})}}(window,jQuery);
//# sourceMappingURL=fancyswitch.min.js.map